<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Install Page</title>
    <link rel="stylesheet" href="./css/installList-filter.css">
    <link rel="stylesheet" href="./css/sidenav.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./css/mod-modal.css">

</head>
<body>
    <div class="sidenav">
        <a href="./main.html">Main</a>
        <a href="./mod.html">Mods</a>
        <button class="dropdown-btn">
            Sets<i class="fa fa-caret-down"></i>
        </button>
        <div class="dropdown-container">
            <a href="#">Set 1</a>
            <a href="#">Set 2</a>
            <a href="#">Set 3</a>
        </div>
        <a href="./install.html">Versions</a>
        <a href="./setting.html">Settings</a>
    </div>

    <div class="main">
        <input type="text" id="myInput" onkeyup="searching()" placeholder="Search for names..">

        <ul id="myUL">
            <li><a href="#">1.18.2</a></li>
        </ul>

        <div id="id01" class="modal">
          <span onclick="close_id01()" class="close" title="Close Modal">&times;</span>
          <form class="modal-content">
            <div class="container">
              <h1>Install Version</h1>
              <p>Do you want to install <b id="ver"></b> minecraft version?</p>

              <div class="clearfix">
                <button type="button" class="cacelbtn" onclick="installVanilla()">Vanilla</button>
                <button type="button" class="deletebtn" onclick="installForge()">Forge</button>
                <button type="button" class="deletebtn" onclick="installFabric()">Fabric</button>
              </div>
            </div>
          </form>
        </div>
        <div id="id02" class="modal">
          <span onclick="close_id02()" class="close" title="Close Modal">&times;</span>
          <form class="modal-content">
            <div class="container">
              <h1>Installing Versions...</h1>
              <p id="status_text">null</p>
              <div id="myProgress">
                <div id="myBar"></div>
              </div>
            </div>
          </form>
        </div>
        <!-- <script>
          var modal = document.getElementById('id01');

          window.onclick = function(event) {
            if (event.target == modal) {
              modal.style.display = 'none';
            }
          }
        </script> -->
        

        <script type="text/javascript" src="./js/add_version.js"></script>
        <script>
          set_minecraft_versions("click_to_install");

          function installVanilla() {
            document.getElementById('id01').style.display = 'none';
            document.getElementById('id02').style.display = 'block';
            var str = document.getElementById('ver').childNodes[0].textContent;
            generate_vanilla(str);
            checking_complete();
          }

          function installFabric() {
            document.getElementById('id01').style.display = 'none';
            document.getElementById('id02').style.display = 'block';
            var str = document.getElementById('ver').childNodes[0].textContent;
            generate_fabric(str);
            checking_complete();
          }

          function installForge() {
            var str = document.getElementById('ver').childNodes[0].textContent;
            generate_forge(str);
          }

          function click_to_install(version) {
            document.getElementById('id01').style.display = 'block';
            document.getElementById('ver').textContent = version;
          }

          function checking_complete() {
            doc = document.getElementById('status_text');
            check_complete = setInterval(function() {
              if (doc.textContent == "Installation complete") {
                close_id02();
                clear_complete(check_complete);
              }
            }, 1000);
          }

          function clear_complete(complete) {
            clearInterval(complete);
          }

          function writingStatus(status) {
            removeChild("status_text");
            setStatusText(status);
          }

          function setStatusProgress(bar_width) {
            var elem = document.getElementById("myBar");
            elem.style.width = bar_width + "%";
          }

          //writingStatus 함수의 부분함수
          //writingStatus만 활용
          function setStatusText(status_text) {
            var text = document.getElementById("status_text");

            tNode = document.createTextNode(status_text);
            text.appendChild(tNode);
          }

          function searching() {
            // Declare variables
            var input, filter, ul, li, a, i, txtValue;
            input = document.getElementById('myInput');
            filter = input.value.toUpperCase();
            ul = document.getElementById("myUL");
            li = ul.getElementsByTagName('li');
        
            // Loop through all list items, and hide those who don't match the search query
            for (i = 0; i < li.length; i++) {
              a = li[i].getElementsByTagName("a")[0];
              txtValue = a.textContent || a.innerText;
              if (txtValue.toUpperCase().indexOf(filter) > -1) {
                li[i].style.display = "";
              } else {
                li[i].style.display = "none";
              }
            }
          }

          function removeChild(id) {
            var child = document.getElementById(id).childNodes[0];
            document.getElementById(id).removeChild(child);
          }

          function close_id02() {
            document.getElementById('id02').style.display = 'none';
          }
          
          function close_id01() {
            //modal을 지운다.
            document.getElementById('id01').style.display = 'none';
          } 

          
        </script>
    </div>
    <script src="./js/sidenav-btn.js"></script>
</body>
</html>